-- Real-Time System Model
-- File format
-- This line is just an example of a comment

-- Resources

Processing_Resource (
        Type                    => Fixed_Priority_Processor,
	Name 	                => CPU_1,
	Worst_Context_Switch 	=> 150,
	Avg_Context_Switch 	=> 100,
	Best_Context_Switch 	=>  50);

Processing_Resource (
        Type                    => Fixed_Priority_Processor,
	Name 	                => CPU_2,
	Worst_Context_Switch 	=> 150,
	Avg_Context_Switch 	=> 100,
	Best_Context_Switch 	=>  50);

Processing_Resource (
	Type 	=> Fixed_Priority_Network,
	Name 	=> RED_1,
	Packet_Worst_Overhead 	=> 20,
	Packet_Avg_Overhead 	=> 15,
	Packet_Best_Overhead 	=> 10,
	Max_Packet_Transmission_Time 	=> 200,
	Min_Packet_Transmission_Time 	=> 200);

-- Shared resources

Shared_Resource (
	Type 	=> Immediate_Ceiling_Resource,
	Name 	=> Dato_PCP_1,
	Ceiling 	=> 5);

Shared_Resource (
	Type 	=> Immediate_Ceiling_Resource,
	Name 	=> Dato_PCP_2,
	Ceiling 	=> 12);

-- Operations

Operation (
	Type	=> Simple,
	Name	=> Proc_11,
	Worst_Case_Execution_Time	=> 250,
	Avg_Case_Execution_Time 	=> 100,
	Best_Case_Execution_Time	=> 10,
        Shared_Resources_To_Lock =>
                      (dato_PCP_1,
                       dato_PCP_2),
        Shared_Resources_To_Unlock =>
                       (Dato_PCP_2,
                        Dato_PCP_1));

Operation (
	Type	=> Simple,
	Name	=> Comunic_11,
	Worst_Case_Execution_Time	=> 700,
	Avg_Case_Execution_Time 	=> 170,
	Best_Case_Execution_Time	=> 10);

Operation (
	Type 	=> Simple,
	Name 	=> Proc_12,
	Worst_Case_Execution_Time 	=> 500,
	Avg_Case_Execution_Time 	=> 300,
	Best_Case_Execution_Time 	=> 0,
        Shared_Resources_To_Lock =>
                      (dato_PCP_1,
                       dato_PCP_2),
        Shared_Resources_To_Unlock =>
                       (Dato_PCP_2,
                        Dato_PCP_1)); 

Operation (
	Type	=> Simple,
	Name	=> Proc_111,
	Worst_Case_Execution_Time	=> 250,
	Avg_Case_Execution_Time 	=> 100,
	Best_Case_Execution_Time	=> 10,
        Shared_Resources_To_Lock =>
                      (dato_PCP_1,
                       dato_PCP_2),
        Shared_Resources_To_Unlock =>
                       (Dato_PCP_2,
                        Dato_PCP_1));

Operation (
	Type 	=> Simple,
	Name 	=> Proc_112,
	Worst_Case_Execution_Time 	=> 500,
	Avg_Case_Execution_Time 	=> 300,
	Best_Case_Execution_Time 	=> 0,
        Shared_Resources_To_Lock =>
                      (
                       dato_PCP_2),
        Shared_Resources_To_Unlock =>
                       (Dato_PCP_2,
                        Dato_PCP_1)); 

Operation (
	Type 	=> Composite,
	Name 	=> Proc_4,
	Composite_Operation_List 	=> (
		Proc_111,
                Proc_112));

Operation (
	Type	=> Simple,
	Name	=> Proc_21,
	Worst_Case_Execution_Time	=> 250,
	Avg_Case_Execution_Time 	=> 100,
	Best_Case_Execution_Time	=> 10);

Operation (
	Type	=> Simple,
	Name	=> Comunic_21,
	Worst_Case_Execution_Time	=> 750,
	Avg_Case_Execution_Time 	=> 150,
	Best_Case_Execution_Time	=> 10);

Operation (
	Type 	=> Simple,
	Name 	=> Proc_22,
	Worst_Case_Execution_Time 	=> 500,
	Avg_Case_Execution_Time 	=> 300,
	Best_Case_Execution_Time 	=> 100); 

Operation (
	Type	=> Simple,
	Name	=> Comunic_22,
	Worst_Case_Execution_Time	=> 250,
	Avg_Case_Execution_Time 	=> 100,
	Best_Case_Execution_Time	=> 10);

Operation (
	Type 	=> Simple,
	Name 	=> Proc_23,
	Worst_Case_Execution_Time 	=> 50,
	Avg_Case_Execution_Time 	=> 10,
	Best_Case_Execution_Time 	=> 5); 

-- Events

-- Scheduling_Servers

Scheduling_Server (
        Type                       => Fixed_Priority,
	Name 	=> Tarea_11,
	Server_Sched_Parameters 	=> (
        	Type 	=> Fixed_Priority_Policy,
        	The_Priority 	=> 6),
	Server_Processing_Resource	=> CPU_1);

Scheduling_Server (
        Type                       => Fixed_Priority,
	Name 	=> Mensaje_11,
	Server_Sched_Parameters 	=> (
              Type => Non_Preemptible_FP_Policy,
	      The_Priority => 5 ),
	Server_Processing_Resource	=> RED_1);

Scheduling_Server (
        Type                       => Fixed_Priority,
	Name 	=> Tarea_12,
	Server_Sched_Parameters 	=> (
        	Type 	=> Fixed_Priority_Policy,
        	The_Priority 	=> 4),
	Server_Processing_Resource	=> CPU_2);


Scheduling_Server (
        Type                       => Fixed_Priority,
	Name 	=> Tarea_21,
	Server_Sched_Parameters 	=> (
        	Type 	=> Fixed_Priority_Policy,
        	The_Priority 	=> 6),
	Server_Processing_Resource	=> CPU_1);

Scheduling_Server (
        Type                       => Fixed_Priority,
	Name 	=> Mensaje_21,
	Server_Sched_Parameters 	=> (
              Type => Non_Preemptible_FP_Policy,
	      The_Priority => 5 ),
	Server_Processing_Resource	=> RED_1);

Scheduling_Server (
        Type                       => Fixed_Priority,
	Name 	=> Tarea_22,
	Server_Sched_Parameters 	=> (
        	Type 	=> Fixed_Priority_Policy,
        	The_Priority 	=> 7),
	Server_Processing_Resource	=> CPU_2);

Scheduling_Server (
        Type                       => Fixed_Priority,
	Name 	=> Mensaje_22,
	Server_Sched_Parameters 	=> (
              Type => Non_Preemptible_FP_Policy,
	      The_Priority => 5 ),
	Server_Processing_Resource	=> RED_1);

Scheduling_Server (
        Type                       => Fixed_Priority,
	Name 	=> Tarea_23,
	Server_Sched_Parameters 	=> (
        	Type 	=> Fixed_Priority_Policy,
        	The_Priority 	=> 2),
	Server_Processing_Resource	=> CPU_1);

-- Transactions

Transaction (
        Type                       => Regular,
	Name 	=> Trans_1,
        External_Events => (
	   (Type 	=> Periodic,
	    Name 	=> Entrada1,
	    Period 	=> 10000,
	    Max_Jitter	=> 50,
 	    Phase 	=> 0)),

	Internal_Events 	=> (
     	      (Type 	=> Regular,
	       Name 	=> e11),
     	      (Type 	=> Regular,
	       Name 	=> e12),
  	      (Type 	=> Regular,
  	       Name 	=> Salida1,
	       Timing_Requirements 	=> (
            	           Type 	=> Hard_Global_Deadline,
	                   Deadline 	=> 10000,
	                   Referenced_Event 	=> entrada1))),

	Event_Handlers 	=> (
	      (Type 	=> Activity,
      	       Input_event 	=> Entrada1,
	       Output_event 	=> e11,
	       Activity_Operation 	=> Proc_112,
               Activity_Server => Tarea_11),
	      (Type 	=> Activity,
      	       Input_event 	=> e11,
	       Output_event 	=> e12,
	       Activity_operation 	=> Comunic_11,
               Activity_Server => Mensaje_11),
	      (Type 	=> Activity,
      	       Input_event 	=> e12,
	       Output_event 	=> Salida1,
	       Activity_operation 	=> Proc_12,
               Activity_Server => Tarea_12)
	)
);

Transaction (
        Type                       => Regular,
	Name 	=> Trans_2,
        External_Events => (
	   (Type 	=> Periodic,
	    Name 	=> Entrada2,
	    Period 	=> 5000,
	    Max_Jitter 	=> 0,
	    Phase 	=> 0)),


	Internal_Events 	=> (
     	      (Type 	=> Regular,
	       Name 	=> e21),
     	      (Type 	=> Regular,
	       Name 	=> e22),
     	      (Type 	=> Regular,
	       Name 	=> e23),
     	      (Type 	=> Regular,
	       Name 	=> e24),
  	      (Type 	=> Regular,
  	       Name 	=> Salida2,
	       Timing_Requirements 	=> (
            	           Type 	=> Hard_Global_Deadline,
	                   Deadline 	=> 4000,
	                   Referenced_Event 	=> entrada2))),

	Event_Handlers 	=> (
	      (Type 	=> Activity,
      	       Input_event 	=> Entrada2,
	       Output_event 	=> e21,
	       Activity_operation 	=> Proc_21,
               Activity_Server => Tarea_21),
	      (Type 	=> Activity,
      	       Input_event 	=> e21,
	       Output_event 	=> e22,
	       Activity_Operation 	=> Comunic_21,
               Activity_Server => Mensaje_21),
	      (Type 	=> Activity,
      	       Input_event 	=> e22,
	       Output_event 	=> e23,
	       Activity_Operation 	=> Proc_22,
               Activity_Server => Tarea_22),
	      (Type 	=> Activity,
      	       Input_event 	=> e23,
	       Output_event 	=> e24,
	       Activity_Operation 	=> Comunic_22,
               Activity_Server => Mensaje_22),
	      (Type 	=> Activity,
      	       Input_event 	=> e24,
	       Output_event 	=> Salida2,
	       Activity_Operation 	=> Proc_22,
               Activity_Server => Tarea_22)
	)
);

